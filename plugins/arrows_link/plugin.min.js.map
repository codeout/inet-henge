{"version":3,"file":"plugin.min.js","mappings":"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","sources":["webpack://inet-henge/webpack/universalModuleDefinition","webpack://inet-henge/external umd \"d3\"","webpack://inet-henge/webpack/bootstrap","webpack://inet-henge/webpack/runtime/define property getters","webpack://inet-henge/webpack/runtime/hasOwnProperty shorthand","webpack://inet-henge/webpack/runtime/make namespace object","webpack://inet-henge/./src/bundle.ts","webpack://inet-henge/./src/meta_data.ts","webpack://inet-henge/./src/util.ts","webpack://inet-henge/./src/node.ts","webpack://inet-henge/./src/link.ts","webpack://inet-henge/./plugins/arrows_link/src/plugin.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"d3\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"d3\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"d3\")) : factory(root[\"d3\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, (__WEBPACK_EXTERNAL_MODULE__990__) => {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__990__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import * as d3 from \"d3\";\n\nimport { Link, LinkDataType } from \"./link\";\n\nexport class Bundle {\n  // Bundle group in the whole graph\n  // {\n  //   \"[<source node id>, <target node id>, \\\"<bundle id>\\\"]\": [<link id>, ...],\n  // }\n  private static groups: Record<string, number[]>;\n\n  // member Links of this Bundle\n  protected readonly links: Link[];\n\n  private color: string;\n  private width: number;\n  private space: number;\n  private _shiftMultiplier: number;\n\n  constructor(links: Link[], public id: number) {\n    this.links = links;\n    this.color = \"#7a4e4e\";\n    this.width = 2;\n    this.space = 4;\n  }\n\n  static divide(links: Link[]) {\n    Bundle.groups = {};\n\n    for (const l of links) {\n      if (l.bundle) {\n        const key = this.groupKey(l);\n        (Bundle.groups[key] || (Bundle.groups[key] = [])).push(l.id);\n      }\n    }\n\n    return Object.values(Bundle.groups).map((ids, i) => {\n      return new Bundle(\n        ids.map((id) => links[id]),\n        i,\n      );\n    });\n  }\n\n  private static groupKey(link: Link) {\n    return JSON.stringify([link.source, link.target, link.bundle]);\n  }\n\n  static render(\n    linkLayer: d3.Selection<any>, // eslint-disable-line @typescript-eslint/no-explicit-any\n    bundles: Bundle[],\n  ) {\n    const bundleGroup = linkLayer\n      .selectAll(\".bundle\")\n      .data(bundles)\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", (d) => d.class());\n\n    const bundle = bundleGroup\n      .append(\"path\")\n      .attr(\"d\", (d) => d.d())\n      .attr(\"stroke\", (d) => d.color)\n      .attr(\"stroke-width\", (d) => d.width)\n      .attr(\"fill\", \"none\")\n      .attr(\"id\", (d) => d.bundleId());\n\n    return bundle;\n  }\n\n  static reset() {\n    Bundle.groups = null;\n  }\n\n  // sort by bundle with preserving order\n  static sortByBundle(links: LinkDataType[]) {\n    return links.sort((a, b) => {\n      switch (true) {\n        case !!a.bundle && !b.bundle:\n          return -1;\n        case !a.bundle && !!b.bundle:\n          return 1;\n        case !a.bundle && !b.bundle:\n          return 0;\n\n        // !!a.bundle && !!b.bundle === true\n        case a.bundle.toString() < b.bundle.toString():\n          return -1;\n        case a.bundle.toString() > b.bundle.toString():\n          return 1;\n\n        default:\n          return 0;\n      }\n    });\n  }\n\n  d() {\n    const first = this.links[0].centerCoordinates();\n    const last = this.links[this.links.length - 1].centerCoordinates();\n    const gap = Math.sqrt(Math.pow(first[0] - last[0], 2) + Math.pow(first[1] - last[1], 2));\n\n    if (gap === 0) {\n      return \"\";\n    }\n\n    const angle = this.links[0].angle() + 90;\n    const start = [\n      ((first[0] - last[0]) * this.space) / gap + first[0],\n      ((first[1] - last[1]) * this.space) / gap + first[1],\n    ];\n    const end = [\n      ((last[0] - first[0]) * this.space) / gap + last[0],\n      ((last[1] - first[1]) * this.space) / gap + last[1],\n    ];\n\n    return `M ${start[0]} ${start[1]} A ${gap / 2 + 10},5 ${angle} 1,0 ${end[0]} ${end[1]}`;\n  }\n\n  private shiftMultiplier() {\n    if (!this._shiftMultiplier) {\n      const members = this.links[0].group() || [];\n      this._shiftMultiplier = this.links.reduce((sum, l) => (sum += l.id - (members.length - 1) / 2), 0) / 2;\n    }\n\n    return this._shiftMultiplier;\n  }\n\n  static shiftBundle(bundle: d3.Selection<Bundle>) {\n    bundle.attr(\"d\", (d) => d.d());\n  }\n\n  private class() {\n    // modified link's class\n    return this.links[0].class().replace(/^link/, \"bundle\");\n  }\n\n  private bundleId() {\n    return `bundle${this.id}`;\n  }\n}\n","export type MetaDataType = { class: string; value: any }; // eslint-disable-line @typescript-eslint/no-explicit-any\n\nexport class MetaData {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  constructor(private data: Record<string, any>, private extraKey?: string) {}\n\n  get(keys: string[]) {\n    return this.slice(keys).filter((k) => typeof k.value === \"string\");\n  }\n\n  private slice(keys: string[]) {\n    if (!this.data) return [];\n\n    if (this.extraKey) return this.sliceWithExtraKey(keys);\n    else return this.sliceWithoutExtraKey(keys);\n  }\n\n  private sliceWithExtraKey(keys: string[]) {\n    const data: MetaDataType[] = [];\n\n    keys.forEach((k) => {\n      if (this.data[k] && this.data[k][this.extraKey]) data.push({ class: k, value: this.data[k][this.extraKey] });\n    });\n\n    return data;\n  }\n\n  private sliceWithoutExtraKey(keys: string[]) {\n    const data: MetaDataType[] = [];\n\n    keys.forEach((k) => {\n      if (this.data[k]) data.push({ class: k, value: this.data[k] });\n    });\n\n    return data;\n  }\n}\n","export function classify(string: string) {\n  return string.replace(\" \", \"-\").toLowerCase();\n}\n","import * as d3 from \"d3\";\n\nimport { Color } from \"./diagram\";\nimport { MetaData, MetaDataType } from \"./meta_data\";\nimport { NodePosition } from \"./position_cache\";\nimport { classify } from \"./util\";\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type Constructor = (data: NodeDataType, id: number, options: NodeOptions) => void;\n\nexport type NodeDataType = {\n  name: string;\n  group: string[];\n  icon: string;\n  meta: Record<string, any>; // eslint-disable-line @typescript-eslint/no-explicit-any\n  class: string;\n};\n\nexport type NodeOptions = {\n  width: number;\n  height: number;\n  metaKeys: string[];\n  color: Color;\n  tooltip: boolean;\n};\n\nclass NodeBase {\n  private static all: Record<string, any>; // eslint-disable-line @typescript-eslint/no-explicit-any\n\n  public name: string;\n  public group: string[];\n  public metaList: MetaDataType[];\n  public meta: Record<string, any>; // eslint-disable-line @typescript-eslint/no-explicit-any\n  public x: number;\n  public y: number;\n\n  private icon: string;\n  private extraClass: string;\n  private width: number;\n  private height: number;\n  private padding: number;\n  private tspanOffset: string;\n\n  constructor(data: NodeDataType, public id: number, private options: NodeOptions) {\n    this.name = data.name;\n    this.group = typeof data.group === \"string\" ? [data.group] : data.group || [];\n    this.icon = data.icon;\n    this.metaList = new MetaData(data.meta).get(options.metaKeys);\n    this.meta = data.meta;\n    this.extraClass = data.class || \"\";\n\n    this.width = options.width || 60;\n    this.height = options.height || 40;\n    this.padding = 3;\n    this.tspanOffset = \"1.1em\";\n\n    this.register(id);\n  }\n\n  private register(id: number) {\n    Node.all = Node.all || {};\n    Node.all[this.name] = id;\n  }\n\n  transform() {\n    const x = this.x - this.width / 2 + this.padding;\n    const y = this.y - this.height / 2 + this.padding;\n    return `translate(${x}, ${y})`;\n  }\n\n  private nodeWidth() {\n    return this.width - 2 * this.padding;\n  }\n\n  private nodeHeight() {\n    return this.height - 2 * this.padding;\n  }\n\n  private xForText() {\n    return this.width / 2;\n  }\n\n  private yForText() {\n    return this.height / 2;\n  }\n\n  static idByName(name: string) {\n    if (Node.all[name] === undefined) throw `Unknown node \"${name}\"`;\n    return Node.all[name];\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static render(layer: d3.Selection<any>, nodes: Node[]) {\n    const node: d3.Selection<Node> = layer\n      .selectAll(\".node\")\n      .data(nodes)\n      .enter()\n      .append(\"g\")\n      .attr(\"id\", (d) => classify(d.name))\n      .attr(\"name\", (d) => d.name)\n      .attr(\"transform\", (d) => d.transform());\n\n    node.each(function (this: SVGGElement, d) {\n      if (d.icon) Node.appendImage(this);\n      else Node.appendRect(this);\n\n      Node.appendText(this);\n    });\n\n    return node;\n  }\n\n  private static appendText(container: SVGGElement) {\n    const text = (d3.select(container) as d3.Selection<Node>)\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", (d) => d.xForText())\n      .attr(\"y\", (d) => d.yForText());\n    text\n      .append(\"tspan\")\n      .text((d) => d.name)\n      .attr(\"x\", (d) => d.xForText());\n\n    text.each((d) => {\n      // Show meta only when \"tooltip\" option is not configured\n      if (!d.options.tooltip) {\n        Node.appendTspans(text, d.metaList);\n      }\n    });\n  }\n\n  private static appendTspans(container: d3.Selection<Node>, meta: MetaDataType[]) {\n    meta.forEach((m) => {\n      container\n        .append(\"tspan\")\n        .attr(\"x\", (d) => d.xForText())\n        .attr(\"dy\", (d) => d.tspanOffset)\n        .attr(\"class\", m.class)\n        .text(m.value);\n    });\n  }\n\n  private static appendImage(container: SVGGElement) {\n    (d3.select(container) as d3.Selection<Node>)\n      .attr(\"class\", (d) => `node image ${classify(d.name)} ${d.extraClass}`)\n      .append(\"image\")\n      .attr(\"xlink:href\", (d) => d.icon)\n      .attr(\"width\", (d) => d.nodeWidth())\n      .attr(\"height\", (d) => d.nodeHeight());\n  }\n\n  private static appendRect(container: SVGGElement) {\n    (d3.select(container) as d3.Selection<Node>)\n      .attr(\"class\", (d) => `node rect ${classify(d.name)} ${d.extraClass}`)\n      .append(\"rect\")\n      .attr(\"width\", (d) => d.nodeWidth())\n      .attr(\"height\", (d) => d.nodeHeight())\n      .attr(\"rx\", 5)\n      .attr(\"ry\", 5)\n      .style(\"fill\", (d) => d.options.color(undefined));\n  }\n\n  static tick(node: d3.Selection<Node>) {\n    node.attr(\"transform\", (d) => d.transform());\n  }\n\n  static setPosition(node: d3.Selection<Node>, position: NodePosition[]) {\n    node.attr(\"transform\", (d, i) => {\n      if (\n        position[i]?.x !== null &&\n        position[i]?.x !== undefined &&\n        position[i]?.y !== null &&\n        position[i]?.y !== undefined\n      ) {\n        d.x = position[i].x;\n        d.y = position[i].y;\n      }\n      return d.transform();\n    });\n  }\n\n  static reset() {\n    Node.all = null;\n  }\n}\n\nconst Eventable = (Base: typeof NodeBase) => {\n  class EventableNode extends Base {\n    private dispatch: d3.Dispatch;\n\n    constructor(data: NodeDataType, id: number, options: NodeOptions) {\n      super(data, id, options);\n\n      this.dispatch = d3.dispatch(\"rendered\");\n    }\n\n    static render(layer, nodes) {\n      const node = super.render(layer, nodes);\n\n      node.each(function (this: SVGGElement, d: Node & EventableNode) {\n        d.dispatch.rendered(this);\n      });\n\n      return node;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    on(name: string, callback: (element: SVGGElement) => any) {\n      this.dispatch.on(name, callback);\n    }\n  }\n\n  return EventableNode;\n};\n\nconst Pluggable = (Base: typeof NodeBase) => {\n  class Node extends Base {\n    private static pluginConstructors: Constructor[] = [];\n\n    constructor(data: NodeDataType, id: number, options: NodeOptions) {\n      super(data, id, options);\n\n      for (const constructor of Node.pluginConstructors) {\n        // Call Pluggable at last as constructor may call methods defined in other classes\n        constructor.bind(this)(data, id, options);\n      }\n    }\n\n    static registerConstructor(func: Constructor) {\n      Node.pluginConstructors.push(func);\n    }\n  }\n\n  return Node;\n};\n\nclass EventableNode extends Eventable(NodeBase) {}\n\n// Call Pluggable at last as constructor may call methods defined in other classes\nclass Node extends Pluggable(EventableNode) {}\n\nexport { Node };\n","import * as d3 from \"d3\";\n\nimport { Bundle } from \"./bundle\";\nimport { MetaData, MetaDataType } from \"./meta_data\";\nimport { Node } from \"./node\";\nimport { LinkPosition } from \"./position_cache\";\nimport { classify } from \"./util\";\n\nexport type Constructor = (data: LinkDataType, id: number, metaKeys: string[], linkWidth: (object) => number) => void;\n\nexport type LinkDataType = {\n  source: string;\n  target: string;\n  bundle?: number | string;\n  meta: Record<string, any>; // eslint-disable-line @typescript-eslint/no-explicit-any\n  class: string;\n};\n\nexport class LinkBase {\n  private static groups: Record<string, number[]>;\n\n  public readonly bundle?: number | string;\n  public readonly source: number | Node;\n  public readonly target: number | Node;\n\n  private readonly metaList: MetaDataType[];\n  private readonly sourceMeta: MetaDataType[];\n  private readonly targetMeta: MetaDataType[];\n  private readonly extraClass: string;\n  private width: number;\n  private readonly defaultMargin: number;\n  private readonly labelXOffset: number;\n  private readonly labelYOffset: number;\n  private color: string;\n  private _margin: number;\n  private _shiftMultiplier: number;\n\n  constructor(data: LinkDataType, public id: number, metaKeys: string[], linkWidth: (object) => number) {\n    this.source = Node.idByName(data.source);\n    this.target = Node.idByName(data.target);\n    this.bundle = data.bundle;\n    this.metaList = new MetaData(data.meta).get(metaKeys);\n    this.sourceMeta = new MetaData(data.meta, \"source\").get(metaKeys);\n    this.targetMeta = new MetaData(data.meta, \"target\").get(metaKeys);\n    this.extraClass = data.class || \"\";\n\n    if (typeof linkWidth === \"function\") this.width = linkWidth(data.meta) || 3;\n    else this.width = linkWidth || 3;\n\n    this.defaultMargin = 15;\n    this.labelXOffset = 20;\n    this.labelYOffset = 1.5; // em\n    this.color = \"#7a4e4e\";\n\n    this.register(id);\n  }\n\n  private register(id: number) {\n    Link.groups = Link.groups || {};\n\n    // source and target\n    const key = [this.source, this.target].sort().toString();\n    (Link.groups[key] || (Link.groups[key] = [])).push(id);\n  }\n\n  private isNamedPath() {\n    return this.metaList.length > 0;\n  }\n\n  private isReversePath() {\n    return this.targetMeta.length > 0;\n  }\n\n  d() {\n    return `M ${(this.source as Node).x} ${(this.source as Node).y} L ${(this.target as Node).x} ${\n      (this.target as Node).y\n    }`;\n  }\n\n  private pathId() {\n    return `path${this.id}`;\n  }\n\n  private linkId() {\n    return `link${this.id}`;\n  }\n\n  private margin() {\n    if (!this._margin) {\n      const margin = window.getComputedStyle(document.getElementById(this.linkId())).margin;\n\n      // NOTE: Assuming that window.getComputedStyle() returns some value link \"10px\"\n      // or \"0px\" even when not defined in .css\n      if (!margin || margin === \"0px\") {\n        this._margin = this.defaultMargin;\n      } else {\n        this._margin = parseInt(margin);\n      }\n    }\n\n    return this._margin;\n  }\n\n  group(): number[] {\n    return Link.groups[[(this.source as Node).id, (this.target as Node).id].sort().toString()];\n  }\n\n  // OPTIMIZE: Implement better right-alignment of the path, especially for multi tspans\n  private tspanXOffset() {\n    if (this.isNamedPath()) return 0;\n    else if (this.isReversePath()) return -this.labelXOffset;\n    else return this.labelXOffset;\n  }\n\n  private tspanYOffset() {\n    if (this.isNamedPath()) return `${-this.labelYOffset + 0.7}em`;\n    else return `${this.labelYOffset}em`;\n  }\n\n  private rotate(bbox: SVGRect) {\n    if ((this.source as Node).x > (this.target as Node).x)\n      return `rotate(180 ${bbox.x + bbox.width / 2} ${bbox.y + bbox.height / 2})`;\n    else return \"rotate(0)\";\n  }\n\n  private split() {\n    if (!this.metaList && !this.sourceMeta && !this.targetMeta) return [this];\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const meta: Record<string, any>[] = [];\n    [\"metaList\", \"sourceMeta\", \"targetMeta\"].forEach((key, i, keys) => {\n      if (this[key]) {\n        const duped = Object.assign(Object.create(this), this);\n\n        keys.filter((k) => k !== key).forEach((k) => (duped[k] = []));\n        meta.push(duped);\n      }\n    });\n\n    return meta;\n  }\n\n  private hasMeta() {\n    return this.metaList.length > 0 || this.sourceMeta.length > 0 || this.targetMeta.length > 0;\n  }\n\n  class() {\n    // eslint-disable-next-line max-len\n    return `link ${classify((this.source as Node).name)} ${classify((this.target as Node).name)} ${classify(\n      (this.source as Node).name,\n    )}-${classify((this.target as Node).name)} ${this.extraClass}`;\n  }\n\n  // after transform is applied\n  centerCoordinates() {\n    const link = d3.select(`.link #${this.linkId()}`).node() as SVGLineElement;\n    const bbox = link.getBBox();\n    const transform = link.transform.baseVal.consolidate();\n\n    return [bbox.x + bbox.width / 2 + transform?.matrix.e || 0, bbox.y + bbox.height / 2 + transform?.matrix.f || 0];\n  }\n\n  angle() {\n    const link = d3.select(`.link #${this.linkId()}`).node() as SVGLineElement;\n    return (\n      (Math.atan2(link.y2.baseVal.value - link.y1.baseVal.value, link.x2.baseVal.value - link.x1.baseVal.value) * 180) /\n      Math.PI\n    );\n  }\n\n  static render(\n    linkLayer: d3.Selection<any>, // eslint-disable-line @typescript-eslint/no-explicit-any\n    labelLayer: d3.Selection<any>, // eslint-disable-line @typescript-eslint/no-explicit-any\n    links: Link[],\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ): [d3.Selection<Link>, d3.Selection<Link>, d3.Selection<any>] {\n    // Render lines\n    const pathGroup = linkLayer\n      .selectAll(\".link\")\n      .data(links)\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", (d) => d.class());\n\n    const link = pathGroup\n      .append(\"line\")\n      .attr(\"x1\", (d) => (d.source as Node).x)\n      .attr(\"y1\", (d) => (d.source as Node).y)\n      .attr(\"x2\", (d) => (d.target as Node).x)\n      .attr(\"y2\", (d) => (d.target as Node).y)\n      .attr(\"stroke\", (d) => d.color)\n      .attr(\"stroke-width\", (d) => d.width)\n      .attr(\"id\", (d) => d.linkId())\n      .on(\"mouseover.line\", (d) => textGroup.selectAll(`text.${d.pathId()}`).classed(\"hover\", true))\n      .on(\"mouseout.line\", (d) => textGroup.selectAll(`text.${d.pathId()}`).classed(\"hover\", false));\n\n    const path = pathGroup\n      .append(\"path\")\n      .attr(\"d\", (d) => d.d())\n      .attr(\"id\", (d) => d.pathId());\n\n    // Render texts\n    const textGroup = labelLayer\n      .selectAll(\".link\")\n      .data(links)\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", (d) => d.class());\n\n    const text = textGroup\n      .selectAll(\"text\")\n      .data((d: Link) => d.split().filter((l: Link) => l.hasMeta()))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", (d: Link) => d.pathId()); // Bind text with pathId as class\n\n    const textPath = text.append(\"textPath\").attr(\"xlink:href\", (d: Link) => `#${d.pathId()}`);\n\n    textPath.each(function (d: Link) {\n      Link.appendTspans(this, d.metaList);\n      Link.appendTspans(this, d.sourceMeta);\n      Link.appendTspans(this, d.targetMeta);\n\n      if (d.isNamedPath()) Link.center(this);\n\n      if (d.isReversePath()) Link.theOtherEnd(this);\n    });\n\n    Link.zoom(); // Initialize\n    return [link, path, text];\n  }\n\n  private static theOtherEnd(container: SVGGElement) {\n    d3.select(container).attr(\"class\", \"reverse\").attr(\"text-anchor\", \"end\").attr(\"startOffset\", \"100%\");\n  }\n\n  private static center(container: SVGGElement) {\n    d3.select(container).attr(\"class\", \"center\").attr(\"text-anchor\", \"middle\").attr(\"startOffset\", \"50%\");\n  }\n\n  private static appendTspans(container: SVGGElement, meta: MetaDataType[]) {\n    meta.forEach((m) => {\n      d3.select(container)\n        .append(\"tspan\")\n        .attr(\"x\", (d: Link) => d.tspanXOffset())\n        .attr(\"dy\", (d: Link) => d.tspanYOffset())\n        .attr(\"class\", m.class)\n        .text(m.value);\n    });\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static tick(link: d3.Selection<Link>, path: d3.Selection<Link>, label: d3.Selection<any>) {\n    link\n      .attr(\"x1\", (d) => (d.source as Node).x)\n      .attr(\"y1\", (d) => (d.source as Node).y)\n      .attr(\"x2\", (d) => (d.target as Node).x)\n      .attr(\"y2\", (d) => (d.target as Node).y);\n\n    if (path) path.attr(\"d\", (d) => d.d());\n    if (label)\n      label.attr(\"transform\", function (d: Link) {\n        return d.rotate(this.getBBox());\n      });\n  }\n\n  static zoom(scale?: number) {\n    let visibility = \"hidden\";\n    if (scale && scale > 1.5) visibility = \"visible\";\n\n    d3.selectAll(\".link text\").style(\"visibility\", visibility);\n  }\n\n  static setPosition(link: d3.Selection<Link>, position: LinkPosition[]) {\n    link\n      .attr(\"x1\", (d, i) => position[i].x1)\n      .attr(\"y1\", (d, i) => position[i].y1)\n      .attr(\"x2\", (d, i) => position[i].x2)\n      .attr(\"y2\", (d, i) => position[i].y2);\n  }\n\n  private shiftMultiplier() {\n    if (!this._shiftMultiplier) {\n      const members = this.group() || [];\n      this._shiftMultiplier = members.indexOf(this.id) - (members.length - 1) / 2;\n    }\n\n    return this._shiftMultiplier;\n  }\n\n  static shiftBundle(\n    link: d3.Selection<Link>,\n    path: d3.Selection<Link>,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    label: d3.Selection<any>,\n    bundle: d3.Selection<Bundle>,\n  ) {\n    const transform = (d: Link) => d.shiftBundle(d.shiftMultiplier());\n\n    link.attr(\"transform\", transform);\n    path.attr(\"transform\", transform);\n    label.attr(\"transform\", transform);\n    Bundle.shiftBundle(bundle);\n  }\n\n  shiftBundle(multiplier: number) {\n    const gap = this.margin() * multiplier;\n\n    const x = (this.target as Node).x - (this.source as Node).x;\n    const y = (this.target as Node).y - (this.source as Node).y;\n    const length = Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\n\n    return `translate(${(-gap * y) / length}, ${(gap * x) / length})`;\n  }\n\n  static reset() {\n    Link.groups = null;\n  }\n}\n\nconst Eventable = (Base: typeof LinkBase) => {\n  class EventableLink extends Base {\n    private dispatch: d3.Dispatch;\n\n    constructor(data: LinkDataType, id: number, metaKeys: string[], linkWidth: (object) => number) {\n      super(data, id, metaKeys, linkWidth);\n\n      this.dispatch = d3.dispatch(\"rendered\");\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    static render(linkLayer, labelLayer, links): [d3.Selection<Link>, d3.Selection<Link>, d3.Selection<any>] {\n      const [link, path, text] = super.render(linkLayer, labelLayer, links);\n\n      link.each(function (this: SVGLineElement, d: Link & EventableLink) {\n        d.dispatch.rendered(this);\n      });\n\n      return [link, path, text];\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    on(name: string, callback: (element: SVGGElement) => any) {\n      this.dispatch.on(name, callback);\n    }\n  }\n\n  return EventableLink;\n};\n\nconst Pluggable = (Base: typeof LinkBase) => {\n  class Link extends Base {\n    private static pluginConstructors: Constructor[] = [];\n\n    constructor(data: LinkDataType, id: number, metaKeys: string[], linkWidth: (object) => number) {\n      super(data, id, metaKeys, linkWidth);\n\n      for (const constructor of Link.pluginConstructors) {\n        // Call Pluggable at last as constructor may call methods defined in other classes\n        constructor.bind(this)(data, id, metaKeys, linkWidth);\n      }\n    }\n\n    static registerConstructor(func: Constructor) {\n      Link.pluginConstructors.push(func);\n    }\n  }\n\n  return Link;\n};\n\nclass EventableLink extends Eventable(LinkBase) {}\n\n// Call Pluggable at last as constructor may call methods defined in other classes\nclass Link extends Pluggable(EventableLink) {}\n\nexport { Link };\n","import * as d3 from \"d3\";\n\nimport { Constructor as LinkConstructor, Link, LinkDataType } from \"../../../src/link\";\nimport { Node } from \"../../../src/node\";\nimport { PluginClass } from \"../../../src/plugin\";\n\nclass ArrowsLink extends Link {\n  public readonly source: number | Node;\n  public readonly target: number | Node;\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static tick(link: d3.Selection<ArrowsLink>, path: d3.Selection<ArrowsLink>, label: d3.Selection<any>) {\n    super.tick(link, path, label);\n\n    link.attr(\"x2\", (d) => d.x2());\n    link.attr(\"y2\", (d) => d.y2());\n  }\n\n  length() {\n    return Math.sqrt(\n      ((this.source as Node).x - (this.target as Node).x) ** 2 +\n        ((this.source as Node).y - (this.target as Node).y) ** 2,\n    );\n  }\n\n  x2() {\n    return (this.source as Node).x + (0.5 - 5 / this.length()) * ((this.target as Node).x - (this.source as Node).x);\n  }\n\n  y2() {\n    return (this.source as Node).y + (0.5 - 5 / this.length()) * ((this.target as Node).y - (this.source as Node).y);\n  }\n}\n\nexport const ArrowsLinkPlugin: PluginClass = class ArrowsLinkPlugin {\n  private static isMarkerDefined = false;\n\n  static load(Group, Node, Link) {\n    Link.registerConstructor(function (\n      /* eslint-disable @typescript-eslint/no-unused-vars */\n      data: LinkDataType,\n      id: number,\n      metaKeys: string[],\n      linkWidth: (object) => number,\n      /* eslint-enable @typescript-eslint/no-unused-vars */\n    ) {\n      this.selected = false;\n\n      this.on(\"rendered\", (element: SVGLineElement) => {\n        ArrowsLinkPlugin.appendMarker(element);\n        if (!ArrowsLinkPlugin.isMarkerDefined) {\n          ArrowsLinkPlugin.defineMarkers();\n        }\n      });\n    } as LinkConstructor);\n\n    // Copy methods\n    Link.tick = ArrowsLink.tick;\n    Link.prototype.length = ArrowsLink.prototype.length;\n    Link.prototype.x2 = ArrowsLink.prototype.x2;\n    Link.prototype.y2 = ArrowsLink.prototype.y2;\n  }\n\n  private static defineMarkers() {\n    const defs = d3.select(\"svg\").append(\"defs\");\n    const define = (id: string) => {\n      defs\n        .append(\"marker\")\n        .attr(\"id\", id)\n        .attr(\"markerWidth\", 10)\n        .attr(\"markerHeight\", 7)\n        .attr(\"refX\", 7.5)\n        .attr(\"orient\", \"auto\")\n        .attr(\"viewBox\", \"0 -5 10 10\")\n        .append(\"path\")\n        .attr(\"d\", \"M0,-5 L10,0 L0,5\");\n    };\n\n    define(\"marker-odd\");\n    define(\"marker-even\");\n    ArrowsLinkPlugin.isMarkerDefined = true;\n  }\n\n  private static appendMarker(element: SVGLineElement) {\n    d3.select(element).attr(\n      \"marker-end\",\n      // For consistency with #links :nth-child(odd), it's one-based\n      (d: ArrowsLink) => (d.id % 2 === 0 ? \"url(#marker-odd)\" : \"url(#marker-even)\"),\n    );\n  }\n};\n\nexport default ArrowsLinkPlugin;\n"],"names":["root","factory","exports","module","require","define","amd","a","i","self","__WEBPACK_EXTERNAL_MODULE__990__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","Bundle","constructor","links","id","this","color","width","space","static","groups","l","bundle","groupKey","push","values","map","ids","link","JSON","stringify","source","target","linkLayer","bundles","selectAll","data","enter","append","attr","class","bundleId","sort","b","toString","first","centerCoordinates","last","length","gap","Math","sqrt","pow","angle","start","end","shiftMultiplier","_shiftMultiplier","members","group","reduce","sum","replace","MetaData","extraKey","keys","slice","filter","k","sliceWithExtraKey","sliceWithoutExtraKey","forEach","classify","string","toLowerCase","NodeBase","options","name","icon","metaList","meta","metaKeys","extraClass","height","padding","tspanOffset","register","Node","all","transform","x","y","nodeWidth","nodeHeight","xForText","yForText","layer","nodes","node","each","appendImage","appendRect","appendText","container","text","tooltip","appendTspans","m","style","position","Eventable","Base","super","dispatch","render","rendered","on","callback","Pluggable","pluginConstructors","bind","func","EventableNode","LinkBase","linkWidth","idByName","sourceMeta","targetMeta","defaultMargin","labelXOffset","labelYOffset","Link","isNamedPath","isReversePath","pathId","linkId","margin","_margin","window","getComputedStyle","document","getElementById","parseInt","tspanXOffset","tspanYOffset","rotate","bbox","split","duped","assign","create","hasMeta","getBBox","baseVal","consolidate","matrix","e","f","atan2","y2","y1","x2","x1","PI","labelLayer","pathGroup","textGroup","classed","path","center","theOtherEnd","zoom","label","scale","visibility","indexOf","shiftBundle","multiplier","EventableLink","ArrowsLink","tick","ArrowsLinkPlugin","Group","registerConstructor","selected","element","appendMarker","isMarkerDefined","defineMarkers","defs"],"sourceRoot":""}