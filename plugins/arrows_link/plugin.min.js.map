{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///external \"d3\"","webpack:///./src/meta_data.ts","webpack:///./src/util.ts","webpack:///./src/node.ts","webpack:///./src/link.ts","webpack:///./plugins/arrows_link/src/plugin.ts"],"names":["root","factory","exports","module","require","define","amd","a","i","window","__WEBPACK_EXTERNAL_MODULE__0__","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","MetaData","data","extraKey","keys","this","slice","filter","k","sliceWithExtraKey","sliceWithoutExtraKey","forEach","push","class","classify","string","replace","toLowerCase","id","metaKeys","color","tooltip","group","icon","meta","extraClass","width","height","padding","tspanOffset","register","Node","all","x","y","undefined","layer","nodes","node","selectAll","enter","append","attr","transform","each","appendImage","appendRect","appendText","container","text","xForText","yForText","appendTspans","nodeWidth","nodeHeight","style","position","Eventable","Base","super","dispatch","render","rendered","callback","on","Pluggable","constructor","pluginConstructors","func","linkWidth","source","idByName","target","sourceMeta","targetMeta","defaultMargin","labelXOffset","labelYOffset","length","_margin","margin","getComputedStyle","document","getElementById","linkId","parseInt","isNamedPath","isReversePath","bbox","duped","assign","linkLayer","labelLayer","links","pathGroup","link","textGroup","pathId","classed","path","split","hasMeta","Link","center","theOtherEnd","zoom","tspanXOffset","tspanYOffset","label","rotate","getBBox","scale","visibility","x1","y1","x2","y2","groups","sort","toString","members","indexOf","shiftBundle","shiftMultiplier","multiplier","gap","Math","abs","sqrt","pow","tick","ArrowsLinkPlugin","Group","registerConstructor","selected","element","appendMarker","isMarkerDefined","defineMarkers","defs"],"mappings":"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","file":"plugin.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"d3\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"d3\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"d3\")) : factory(root[\"d3\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","export type MetaDataType = { class: string, value: any }  // eslint-disable-line @typescript-eslint/no-explicit-any\n\nexport class MetaData {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  constructor(private data: Record<string, any>, private extraKey?: string) {\n  }\n\n  get(keys: string[]): MetaDataType[] {\n    return this.slice(keys).filter((k) => typeof k.value === \"string\");\n  }\n\n  slice(keys: string[]): MetaDataType[] {\n    if (!this.data)\n      return [];\n\n    if (this.extraKey)\n      return this.sliceWithExtraKey(keys);\n    else\n      return this.sliceWithoutExtraKey(keys);\n  }\n\n  sliceWithExtraKey(keys: string[]): MetaDataType[] {\n    const data = [];\n\n    keys.forEach((k) => {\n      if (this.data[k] && this.data[k][this.extraKey])\n        data.push({ class: k, value: this.data[k][this.extraKey] });\n    });\n\n    return data;\n  }\n\n  sliceWithoutExtraKey(keys: string[]): MetaDataType[] {\n    const data = [];\n\n    keys.forEach((k) => {\n      if (this.data[k])\n        data.push({ class: k, value: this.data[k] });\n    });\n\n    return data;\n  }\n}\n","export function classify(string: string): string {\n  return string.replace(\" \", \"-\").toLowerCase();\n}\n","import * as d3 from \"d3\";\n\nimport { MetaData, MetaDataType } from \"./meta_data\";\nimport { NodePosition } from \"./position_cache\";\nimport { classify } from \"./util\";\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type Constructor = (data: NodeDataType, id: number, metaKeys: string[], color: any, tooltip: boolean) => void;\n\nexport type NodeDataType = {\n  name: string,\n  group: string[],\n  icon: string,\n  meta: Record<string, any>,  // eslint-disable-line @typescript-eslint/no-explicit-any\n  class: string,\n}\n\nclass NodeBase {\n  private static all: Record<string, any>;  // eslint-disable-line @typescript-eslint/no-explicit-any\n\n  public name: string;\n  public group: string[];\n  public meta: MetaDataType[];\n  public x: number;\n  public y: number;\n\n  private icon: string;\n  private extraClass: string;\n  private width: number;\n  private height: number;\n  private padding: number;\n  private tspanOffset: string;\n\n  // Fix @types/d3/index.d.ts. Should be \"d3.scale.Ordinal<number, string>\" but \"d3.scale.Ordinal<string, string>\" somehow\n  // Also, it should have accepted undefined\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  constructor(data: NodeDataType, public id: number, metaKeys: string[], private color: any, private tooltip: boolean) {\n    this.name = data.name;\n    this.group = typeof data.group === \"string\" ? [data.group] : (data.group || []);\n    this.icon = data.icon;\n    this.meta = new MetaData(data.meta).get(metaKeys);\n    this.extraClass = data.class || \"\";\n\n    this.width = 60;\n    this.height = 40;\n    this.padding = 3;\n    this.tspanOffset = \"1.1em\";\n\n    this.register(id, data.name);\n  }\n\n  register(id: number, name: string): void {\n    Node.all = Node.all || {};\n    Node.all[name] = id;\n  }\n\n  transform(): string {\n    const x = this.x - this.width / 2 + this.padding;\n    const y = this.y - this.height / 2 + this.padding;\n    return `translate(${x}, ${y})`;\n  }\n\n  nodeWidth(): number {\n    return this.width - 2 * this.padding;\n  }\n\n  nodeHeight(): number {\n    return this.height - 2 * this.padding;\n  }\n\n  xForText(): number {\n    return this.width / 2;\n  }\n\n  yForText(): number {\n    return this.height / 2;\n  }\n\n  static idByName(name: string): number {\n    if (Node.all[name] === undefined)\n      throw `Unknown node \"${name}\"`;\n    return Node.all[name];\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static render(layer: d3.Selection<any>, nodes: Node[]): d3.Selection<Node> {\n    const node = layer.selectAll(\".node\")\n      .data(nodes)\n      .enter()\n      .append(\"g\")\n      .attr(\"id\", (d) => classify(d.name))\n      .attr(\"name\", (d) => d.name)\n      .attr(\"transform\", (d) => d.transform());\n\n    node.each(function(this: SVGGElement, d) {\n      if (d.icon)\n        Node.appendImage(this);\n      else\n        Node.appendRect(this);\n\n      Node.appendText(this);\n    });\n\n    return node;\n  }\n\n  private static appendText(container: SVGGElement): void {\n    const text = (d3.select(container) as d3.Selection<Node>).append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", (d) => d.xForText())\n      .attr(\"y\", (d) => d.yForText());\n    text.append(\"tspan\")\n      .text((d) => d.name)\n      .attr(\"x\", (d) => d.xForText());\n\n    text.each((d) => {\n      // Show meta only when \"tooltip\" option is not configured\n      if (!d.tooltip) {\n        Node.appendTspans(text, d.meta);\n      }\n    });\n  }\n\n  private static appendTspans(container: d3.Selection<Node>, meta: MetaDataType[]): void {\n    meta.forEach((m) => {\n      container.append(\"tspan\")\n        .attr(\"x\", (d) => d.xForText())\n        .attr(\"dy\", (d) => d.tspanOffset)\n        .attr(\"class\", m.class)\n        .text(m.value);\n    });\n  }\n\n  private static appendImage(container: SVGGElement): void {\n    (d3.select(container) as d3.Selection<Node>)\n      .attr(\"class\", (d) => `node image ${classify(d.name)} ${d.extraClass}`)\n      .append(\"image\")\n      .attr(\"xlink:href\", (d) => d.icon)\n      .attr(\"width\", (d) => d.nodeWidth())\n      .attr(\"height\", (d) => d.nodeHeight());\n  }\n\n  private static appendRect(container: SVGGElement): void {\n    (d3.select(container) as d3.Selection<Node>)\n      .attr(\"class\", (d) => `node rect ${classify(d.name)} ${d.extraClass}`)\n      .append(\"rect\")\n      .attr(\"width\", (d) => d.nodeWidth())\n      .attr(\"height\", (d) => d.nodeHeight())\n      .attr(\"rx\", 5)\n      .attr(\"ry\", 5)\n      .style(\"fill\", (d) => d.color());\n  }\n\n  static tick(node: d3.Selection<Node>): void {\n    node.attr(\"transform\", (d) => d.transform());\n  }\n\n  static setPosition(node: d3.Selection<Node>, position: NodePosition[]): void {\n    node.attr(\"transform\", (d, i) => {\n      d.x = position[i].x;\n      d.y = position[i].y;\n      return d.transform();\n    });\n  }\n\n  static reset(): void {\n    Node.all = null;\n  }\n}\n\nconst Eventable = (Base: typeof NodeBase) => {\n  class EventableNode extends Base {\n    private dispatch: d3.Dispatch;\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(data: NodeDataType, id: number, metaKeys: string[], color: any, tooltip: boolean) {\n      super(data, id, metaKeys, color, tooltip);\n\n      this.dispatch = d3.dispatch(\"rendered\");\n    }\n\n    static render(layer, nodes) {\n      const node = super.render(layer, nodes);\n\n      node.each(function(this: SVGGElement, d: Node & EventableNode) {\n        d.dispatch.rendered(this);\n      });\n\n      return node;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    on(name: string, callback: (element: SVGGElement) => any): void {\n      this.dispatch.on(name, callback);\n    }\n  }\n\n  return EventableNode;\n};\n\nconst Pluggable = (Base: typeof NodeBase) => {\n  class Node extends Base {\n    private static pluginConstructors: Constructor[] = [];\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(data: NodeDataType, id: number, metaKeys: string[], color: any, tooltip: boolean) {\n      super(data, id, metaKeys, color, tooltip);\n\n      for (const constructor of Node.pluginConstructors) {\n        // Call Pluggable at last as constructor may call methods defined in other classes\n        constructor.bind(this)(data, id, metaKeys, color, tooltip);\n      }\n    }\n\n    static registerConstructor(func: Constructor): void {\n      Node.pluginConstructors.push(func);\n    }\n  }\n\n  return Node;\n};\n\nclass EventableNode extends Eventable(NodeBase) {\n}\n\n// Call Pluggable at last as constructor may call methods defined in other classes\nclass Node extends Pluggable(EventableNode) {\n}\n\nexport { Node };\n","import * as d3 from \"d3\";\n\nimport { MetaData, MetaDataType } from \"./meta_data\";\nimport { Node } from \"./node\";\nimport { LinkPosition } from \"./position_cache\";\nimport { classify } from \"./util\";\n\nexport type Constructor = (data: LinkDataType, id: number, metaKeys: string[], linkWidth: (object) => number) => void;\n\nexport type LinkDataType = {\n  source: string,\n  target: string,\n  meta: Record<string, any>,  // eslint-disable-line @typescript-eslint/no-explicit-any\n  class: string,\n}\n\nexport class LinkBase {\n  private static groups: Record<string, any>;  // eslint-disable-line @typescript-eslint/no-explicit-any\n\n  protected readonly source: number | Node;\n  protected readonly target: number | Node;\n  private readonly meta: MetaDataType[];\n  private readonly sourceMeta: MetaDataType[];\n  private readonly targetMeta: MetaDataType[];\n  private readonly extraClass: string;\n  private width: number;\n  private readonly defaultMargin: number;\n  private readonly labelXOffset: number;\n  private readonly labelYOffset: number;\n  private color: string;\n  private _margin: number;\n\n  constructor(data: LinkDataType, public id: number, metaKeys: string[], linkWidth: (object) => number) {\n    this.source = Node.idByName(data.source);\n    this.target = Node.idByName(data.target);\n    this.meta = new MetaData(data.meta).get(metaKeys);\n    this.sourceMeta = new MetaData(data.meta, \"source\").get(metaKeys);\n    this.targetMeta = new MetaData(data.meta, \"target\").get(metaKeys);\n    this.extraClass = data.class || \"\";\n\n    if (typeof linkWidth === \"function\")\n      this.width = linkWidth(data.meta) || 3;\n    else\n      this.width = linkWidth || 3;\n\n    this.defaultMargin = 15;\n    this.labelXOffset = 20;\n    this.labelYOffset = 1.5; // em\n    this.color = \"#7a4e4e\";\n\n    this.register(id, this.source, this.target);\n  }\n\n  isNamedPath(): boolean {\n    return this.meta.length > 0;\n  }\n\n  isReversePath(): boolean {\n    return this.targetMeta.length > 0;\n  }\n\n  d(): string {\n    return `M ${(this.source as Node).x} ${(this.source as Node).y} L ${(this.target as Node).x} ${(this.target as Node).y}`;\n  }\n\n  pathId(): string {\n    return `path${this.id}`;\n  }\n\n  linkId(): string {\n    return `link${this.id}`;\n  }\n\n  margin(): number {\n    if (!this._margin) {\n      const margin = window.getComputedStyle(document.getElementById(this.linkId())).margin;\n\n      // NOTE: Assuming that window.getComputedStyle() returns some value link \"10px\"\n      // or \"0px\" even when not defined in .css\n      if (!margin || margin === \"0px\") {\n        this._margin = this.defaultMargin;\n      } else {\n        this._margin = parseInt(margin);\n      }\n    }\n\n    return this._margin;\n  }\n\n  // OPTIMIZE: Implement better right-alignment of the path, especially for multi tspans\n  tspanXOffset(): number {\n    if (this.isNamedPath())\n      return 0;\n    else if (this.isReversePath())\n      return -this.labelXOffset;\n    else\n      return this.labelXOffset;\n  }\n\n  tspanYOffset(): string {\n    if (this.isNamedPath())\n      return `${-this.labelYOffset + 0.7}em`;\n    else\n      return `${this.labelYOffset}em`;\n  }\n\n  rotate(bbox: SVGRect): string {\n    if ((this.source as Node).x > (this.target as Node).x)\n      return `rotate(180 ${bbox.x + bbox.width / 2} ${bbox.y + bbox.height / 2})`;\n    else\n      return \"rotate(0)\";\n  }\n\n  split(): Record<string, any>[] {  // eslint-disable-line @typescript-eslint/no-explicit-any\n    if (!this.meta && !this.sourceMeta && !this.targetMeta)\n      return [this];\n\n    const meta = [];\n    [\"meta\", \"sourceMeta\", \"targetMeta\"].forEach((key, i, keys) => {\n      if (this[key]) {\n        const duped = Object.assign(Object.create(this), this);\n\n        keys.filter((k) => k !== key).forEach((k) => duped[k] = []);\n        meta.push(duped);\n      }\n    });\n\n    return meta;\n  }\n\n  hasMeta(): boolean {\n    return this.meta.length > 0 || this.sourceMeta.length > 0 || this.targetMeta.length > 0;\n  }\n\n  class(): string {\n    // eslint-disable-next-line max-len\n    return `link ${classify((this.source as Node).name)} ${classify((this.target as Node).name)} ${classify((this.source as Node).name)}-${classify((this.target as Node).name)} ${this.extraClass}`;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static render(linkLayer: d3.Selection<any>, labelLayer: d3.Selection<any>, links: Link[]): [d3.Selection<Link>, d3.Selection<Link>, d3.Selection<any>] {\n    // Render lines\n    const pathGroup = linkLayer.selectAll(\".link\")\n      .data(links)\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", (d) => d.class());\n\n    const link = pathGroup.append(\"line\")\n      .attr(\"x1\", (d) => (d.source as Node).x)\n      .attr(\"y1\", (d) => (d.source as Node).y)\n      .attr(\"x2\", (d) => (d.target as Node).x)\n      .attr(\"y2\", (d) => (d.target as Node).y)\n      .attr(\"stroke\", (d) => d.color)\n      .attr(\"stroke-width\", (d) => d.width)\n      .attr(\"id\", (d) => d.linkId())\n      .on(\"mouseover.line\", (d) => textGroup.selectAll(`text.${d.pathId()}`).classed(\"hover\", true))\n      .on(\"mouseout.line\", (d) => textGroup.selectAll(`text.${d.pathId()}`).classed(\"hover\", false));\n\n    const path = pathGroup.append(\"path\")\n      .attr(\"d\", (d) => d.d())\n      .attr(\"id\", (d) => d.pathId());\n\n    // Render texts\n    const textGroup = labelLayer.selectAll(\".link\")\n      .data(links)\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", (d) => d.class());\n\n    const text = textGroup.selectAll(\"text\")\n      .data((d: Link) => d.split().filter((l: Link) => l.hasMeta()))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", (d: Link) => d.pathId()); // Bind text with pathId as class\n\n    const textPath = text.append(\"textPath\")\n      .attr(\"xlink:href\", (d: Link) => `#${d.pathId()}`);\n\n    textPath.each(function(d: Link) {\n      Link.appendTspans(this, d.meta);\n      Link.appendTspans(this, d.sourceMeta);\n      Link.appendTspans(this, d.targetMeta);\n\n      if (d.isNamedPath())\n        Link.center(this);\n\n      if (d.isReversePath())\n        Link.theOtherEnd(this);\n    });\n\n    Link.zoom(); // Initialize\n    return [link, path, text];\n  }\n\n  private static theOtherEnd(container: SVGGElement): void {\n    d3.select(container)\n      .attr(\"class\", \"reverse\")\n      .attr(\"text-anchor\", \"end\")\n      .attr(\"startOffset\", \"100%\");\n  }\n\n  private static center(container: SVGGElement): void {\n    d3.select(container)\n      .attr(\"class\", \"center\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"startOffset\", \"50%\");\n  }\n\n  private static appendTspans(container: SVGGElement, meta: MetaDataType[]): void {\n    meta.forEach((m) => {\n      d3.select(container).append(\"tspan\")\n        .attr(\"x\", (d: Link) => d.tspanXOffset())\n        .attr(\"dy\", (d: Link) => d.tspanYOffset())\n        .attr(\"class\", m.class)\n        .text(m.value);\n    });\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static tick(link: d3.Selection<Link>, path: d3.Selection<Link>, label: d3.Selection<any>): void {\n    link.attr(\"x1\", (d) => (d.source as Node).x)\n      .attr(\"y1\", (d) => (d.source as Node).y)\n      .attr(\"x2\", (d) => (d.target as Node).x)\n      .attr(\"y2\", (d) => (d.target as Node).y);\n\n    if (path)\n      path.attr(\"d\", (d) => d.d());\n    if (label)\n      label.attr(\"transform\", function(d: Link) {\n        return d.rotate(this.getBBox());\n      });\n  }\n\n  static zoom(scale?: number): void {\n    let visibility = \"hidden\";\n    if (scale && scale > 1.5)\n      visibility = \"visible\";\n\n    d3.selectAll(\".link text\")\n      .style(\"visibility\", visibility);\n  }\n\n  static setPosition(link: d3.Selection<Link>, position: LinkPosition[]): void {\n    link.attr(\"x1\", (d, i) => position[i].x1)\n      .attr(\"y1\", (d, i) => position[i].y1)\n      .attr(\"x2\", (d, i) => position[i].x2)\n      .attr(\"y2\", (d, i) => position[i].y2);\n  }\n\n  register(id: number, source: number, target: number): void {\n    Link.groups = Link.groups || {};\n    const key = [source, target].sort().toString();\n    Link.groups[key] = Link.groups[key] || [];\n    Link.groups[key].push(id);\n  }\n\n  private static shiftMultiplier(link: Link): number {\n    const members = Link.groups[[(link.source as Node).id, (link.target as Node).id].sort().toString()] || [];\n    return members.indexOf(link.id) - (members.length - 1) / 2;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static shiftBundle(link: d3.Selection<Link>, path: d3.Selection<Link>, label: d3.Selection<any>): void {\n    const transform = (d) => d.shiftBundle(Link.shiftMultiplier(d));\n\n    link.attr(\"transform\", transform);\n    path.attr(\"transform\", transform);\n    label.attr(\"transform\", transform);\n  }\n\n  shiftBundle(multiplier: number): string {\n    const gap = this.margin() * multiplier;\n\n    const width = Math.abs((this.target as Node).x - (this.source as Node).x);\n    const height = Math.abs((this.source as Node).y - (this.target as Node).y);\n    const length = Math.sqrt(Math.pow(width, 2) + Math.pow(height, 2));\n\n    return `translate(${gap * height / length}, ${gap * width / length})`;\n  }\n\n  static reset(): void {\n    Link.groups = null;\n  }\n}\n\nconst Eventable = (Base: typeof LinkBase) => {\n  class EventableLink extends Base {\n    private dispatch: d3.Dispatch;\n\n    constructor(data: LinkDataType, id: number, metaKeys: string[], linkWidth: (object) => number) {\n      super(data, id, metaKeys, linkWidth);\n\n      this.dispatch = d3.dispatch(\"rendered\");\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    static render(linkLayer, labelLayer, links): [d3.Selection<Link>, d3.Selection<Link>, d3.Selection<any>] {\n      const [link, path, text] = super.render(linkLayer, labelLayer, links);\n\n      link.each(function(this: SVGLineElement, d: Link & EventableLink) {\n        d.dispatch.rendered(this);\n      });\n\n      return [link, path, text];\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    on(name: string, callback: (element: SVGGElement) => any): void {\n      this.dispatch.on(name, callback);\n    }\n  }\n\n  return EventableLink;\n};\n\nconst Pluggable = (Base: typeof LinkBase) => {\n  class Link extends Base {\n    private static pluginConstructors: Constructor[] = [];\n\n    constructor(data: LinkDataType, id: number, metaKeys: string[], linkWidth: (object) => number) {\n      super(data, id, metaKeys, linkWidth);\n\n      for (const constructor of Link.pluginConstructors) {\n        // Call Pluggable at last as constructor may call methods defined in other classes\n        constructor.bind(this)(data, id, metaKeys, linkWidth);\n      }\n    }\n\n    static registerConstructor(func: Constructor): void {\n      Link.pluginConstructors.push(func);\n    }\n  }\n\n  return Link;\n};\n\nclass EventableLink extends Eventable(LinkBase) {\n}\n\n// Call Pluggable at last as constructor may call methods defined in other classes\nclass Link extends Pluggable(EventableLink) {\n}\n\nexport { Link };\n","import * as d3 from \"d3\";\n\nimport { Constructor as LinkConstructor, Link, LinkDataType } from \"../../../src/link\";\nimport { Node } from \"../../../src/node\";\nimport { PluginClass } from \"../../../src/plugin\";\n\nclass ArrowsLink extends Link {\n  protected readonly source: number | Node;\n  protected readonly target: number | Node;\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static tick(link: d3.Selection<ArrowsLink>, path: d3.Selection<ArrowsLink>, label: d3.Selection<any>): void {\n    super.tick(link, path, label);\n\n    link.attr(\"x2\", (d) => d.x2());\n    link.attr(\"y2\", (d) => d.y2());\n  }\n\n  length(): number {\n    return Math.sqrt(((this.source as Node).x - (this.target as Node).x) ** 2 + ((this.source as Node).y - (this.target as Node).y) ** 2);\n  }\n\n  x2(): number {\n    return (this.source as Node).x + (0.5 - 5 / this.length()) * ((this.target as Node).x - (this.source as Node).x);\n  }\n\n  y2(): number {\n    return (this.source as Node).y + (0.5 - 5 / this.length()) * ((this.target as Node).y - (this.source as Node).y);\n  }\n}\n\nexport const ArrowsLinkPlugin: PluginClass = class ArrowsLinkPlugin {\n  private static isMarkerDefined = false;\n\n  // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n  static load(Group, Node, Link): void {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars, @typescript-eslint/no-explicit-any\n    Link.registerConstructor(function(data: LinkDataType, id: number, metaKeys: string[], linkWidth: (object) => number) {\n      this.selected = false;\n\n      this.on(\"rendered\", (element: SVGLineElement) => {\n        ArrowsLinkPlugin.appendMarker(element);\n        if (!ArrowsLinkPlugin.isMarkerDefined) {\n          ArrowsLinkPlugin.defineMarkers();\n        }\n      });\n\n    } as LinkConstructor);\n\n    // Copy methods\n    Link.tick = ArrowsLink.tick;\n    Link.prototype.length = ArrowsLink.prototype.length;\n    Link.prototype.x2 = ArrowsLink.prototype.x2;\n    Link.prototype.y2 = ArrowsLink.prototype.y2;\n  }\n\n  private static defineMarkers() {\n    const defs = d3.select(\"svg\").append(\"defs\");\n    const define = (id: string) => {\n      defs.append(\"marker\")\n        .attr(\"id\", id)\n        .attr(\"markerWidth\", 10)\n        .attr(\"markerHeight\", 7)\n        .attr(\"refX\", 7.5)\n        .attr(\"orient\", \"auto\")\n        .attr(\"viewBox\", \"0 -5 10 10\")\n        .append(\"path\")\n        .attr(\"d\", \"M0,-5 L10,0 L0,5\");\n    };\n\n    define(\"marker-odd\");\n    define(\"marker-even\");\n    ArrowsLinkPlugin.isMarkerDefined = true;\n  }\n\n  private static appendMarker(element: SVGLineElement) {\n    d3.select(element).attr(\n      \"marker-end\",\n      // For consistency with #links :nth-child(odd), it's one-based\n      (d: ArrowsLink) => d.id % 2 === 0 ? \"url(#marker-odd)\" : \"url(#marker-even)\"\n    );\n  }\n};\n\nexport default ArrowsLinkPlugin;\n"],"sourceRoot":""}