{"version":3,"file":"plugin.min.js","mappings":"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","sources":["webpack://inet-henge/webpack/universalModuleDefinition","webpack://inet-henge/external umd \"d3\"","webpack://inet-henge/webpack/bootstrap","webpack://inet-henge/webpack/runtime/define property getters","webpack://inet-henge/webpack/runtime/hasOwnProperty shorthand","webpack://inet-henge/webpack/runtime/make namespace object","webpack://inet-henge/./src/bundle.ts","webpack://inet-henge/./src/meta_data.ts","webpack://inet-henge/./src/util.ts","webpack://inet-henge/./src/node.ts","webpack://inet-henge/./src/link.ts","webpack://inet-henge/./plugins/arrows_link/src/plugin.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"d3\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"d3\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"d3\")) : factory(root[\"d3\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, (__WEBPACK_EXTERNAL_MODULE__893__) => {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__893__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import * as d3 from \"d3\";\n\nimport { Link, LinkDataType } from \"./link\";\n\nexport class Bundle {\n  // Bundle group in the whole graph\n  // {\n  //   \"[<source node id>, <target node id>, \\\"<bundle id>\\\"]\": [<link id>, ...],\n  // }\n  private static groups: Record<string, number[]>;\n\n  // member Links of this Bundle\n  protected readonly links: Link[];\n\n  private color: string;\n  private width: number;\n  private space: number;\n  private _shiftMultiplier: number;\n\n  constructor(\n    links: Link[],\n    public id: number,\n  ) {\n    this.links = links;\n    this.color = \"#7a4e4e\";\n    this.width = 2;\n    this.space = 4;\n  }\n\n  static divide(links: Link[]) {\n    Bundle.groups = {};\n\n    for (const l of links) {\n      if (l.bundle) {\n        const key = this.groupKey(l);\n        (Bundle.groups[key] || (Bundle.groups[key] = [])).push(l.id);\n      }\n    }\n\n    return Object.values(Bundle.groups).map((ids, i) => {\n      return new Bundle(\n        ids.map((id) => links[id]),\n        i,\n      );\n    });\n  }\n\n  private static groupKey(link: Link) {\n    return JSON.stringify([link.source, link.target, link.bundle]);\n  }\n\n  static render(\n    linkLayer: d3.Selection<any>, // eslint-disable-line @typescript-eslint/no-explicit-any\n    bundles: Bundle[],\n  ) {\n    const bundleGroup = linkLayer\n      .selectAll(\".bundle\")\n      .data(bundles)\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", (d) => d.class());\n\n    const bundle = bundleGroup\n      .append(\"path\")\n      .attr(\"d\", (d) => d.d())\n      .attr(\"stroke\", (d) => d.color)\n      .attr(\"stroke-width\", (d) => d.width)\n      .attr(\"fill\", \"none\")\n      .attr(\"id\", (d) => d.bundleId());\n\n    return bundle;\n  }\n\n  static reset() {\n    Bundle.groups = null;\n  }\n\n  // sort by bundle with preserving order\n  static sortByBundle(links: LinkDataType[]) {\n    return links.sort((a, b) => {\n      switch (true) {\n        case !!a.bundle && !b.bundle:\n          return -1;\n        case !a.bundle && !!b.bundle:\n          return 1;\n        case !a.bundle && !b.bundle:\n          return 0;\n\n        // !!a.bundle && !!b.bundle === true\n        case a.bundle.toString() < b.bundle.toString():\n          return -1;\n        case a.bundle.toString() > b.bundle.toString():\n          return 1;\n\n        default:\n          return 0;\n      }\n    });\n  }\n\n  d() {\n    const first = this.links[0].centerCoordinates();\n    const last = this.links[this.links.length - 1].centerCoordinates();\n    const gap = Math.sqrt(Math.pow(first[0] - last[0], 2) + Math.pow(first[1] - last[1], 2));\n\n    if (gap === 0) {\n      return \"\";\n    }\n\n    const angle = this.links[0].angle() + 90;\n    const start = [\n      ((first[0] - last[0]) * this.space) / gap + first[0],\n      ((first[1] - last[1]) * this.space) / gap + first[1],\n    ];\n    const end = [\n      ((last[0] - first[0]) * this.space) / gap + last[0],\n      ((last[1] - first[1]) * this.space) / gap + last[1],\n    ];\n\n    return `M ${start[0]} ${start[1]} A ${gap / 2 + 10},5 ${angle} 1,0 ${end[0]} ${end[1]}`;\n  }\n\n  private shiftMultiplier() {\n    if (!this._shiftMultiplier) {\n      const members = this.links[0].group() || [];\n      this._shiftMultiplier = this.links.reduce((sum, l) => (sum += l.id - (members.length - 1) / 2), 0) / 2;\n    }\n\n    return this._shiftMultiplier;\n  }\n\n  static shiftBundle(bundle: d3.Selection<Bundle>) {\n    bundle.attr(\"d\", (d) => d.d());\n  }\n\n  private class() {\n    // modified link's class\n    return this.links[0].class().replace(/^link/, \"bundle\");\n  }\n\n  private bundleId() {\n    return `bundle${this.id}`;\n  }\n}\n","export type MetaDataType = { class: string; value: any }; // eslint-disable-line @typescript-eslint/no-explicit-any\n\nexport class MetaData {\n  constructor(\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    private data: Record<string, any>,\n    private extraKey?: string,\n  ) {}\n\n  get(keys: string[]) {\n    return this.slice(keys).filter((k) => typeof k.value === \"string\");\n  }\n\n  private slice(keys: string[]) {\n    if (!this.data) return [];\n\n    if (this.extraKey) return this.sliceWithExtraKey(keys);\n    else return this.sliceWithoutExtraKey(keys);\n  }\n\n  private sliceWithExtraKey(keys: string[]) {\n    const data: MetaDataType[] = [];\n\n    keys.forEach((k) => {\n      if (this.data[k] && this.data[k][this.extraKey]) data.push({ class: k, value: this.data[k][this.extraKey] });\n    });\n\n    return data;\n  }\n\n  private sliceWithoutExtraKey(keys: string[]) {\n    const data: MetaDataType[] = [];\n\n    keys.forEach((k) => {\n      if (this.data[k]) data.push({ class: k, value: this.data[k] });\n    });\n\n    return data;\n  }\n}\n","export function classify(string: string) {\n  return string.replace(\" \", \"-\").toLowerCase();\n}\n","import * as d3 from \"d3\";\n\nimport { Color } from \"./diagram\";\nimport { MetaData, MetaDataType } from \"./meta_data\";\nimport { NodePosition } from \"./position_cache\";\nimport { classify } from \"./util\";\n\nexport type Constructor = (data: NodeDataType, id: number, options: NodeOptions) => void;\n\nexport type NodeDataType = {\n  name: string;\n  group: string[];\n  icon: string;\n  meta: Record<string, any>; // eslint-disable-line @typescript-eslint/no-explicit-any\n  class: string;\n};\n\nexport type NodeOptions = {\n  width: number;\n  height: number;\n  metaKeys: string[];\n  color: Color;\n  tooltip: boolean;\n};\n\nclass NodeBase {\n  private static all: Record<string, any>; // eslint-disable-line @typescript-eslint/no-explicit-any\n\n  public name: string;\n  public group: string[];\n  public metaList: MetaDataType[];\n  public meta: Record<string, any>; // eslint-disable-line @typescript-eslint/no-explicit-any\n  public x: number;\n  public y: number;\n\n  private icon: string;\n  private extraClass: string;\n  private width: number;\n  private height: number;\n  private padding: number;\n  private tspanOffset: string;\n\n  constructor(\n    data: NodeDataType,\n    public id: number,\n    private options: NodeOptions,\n  ) {\n    this.name = data.name;\n    this.group = typeof data.group === \"string\" ? [data.group] : data.group || [];\n    this.icon = data.icon;\n    this.metaList = new MetaData(data.meta).get(options.metaKeys);\n    this.meta = data.meta;\n    this.extraClass = data.class || \"\";\n\n    this.width = options.width || 60;\n    this.height = options.height || 40;\n    this.padding = 3;\n    this.tspanOffset = \"1.1em\";\n\n    this.register(id);\n  }\n\n  private register(id: number) {\n    Node.all = Node.all || {};\n    Node.all[this.name] = id;\n  }\n\n  transform() {\n    const x = this.x - this.width / 2 + this.padding;\n    const y = this.y - this.height / 2 + this.padding;\n    return `translate(${x}, ${y})`;\n  }\n\n  private nodeWidth() {\n    return this.width - 2 * this.padding;\n  }\n\n  private nodeHeight() {\n    return this.height - 2 * this.padding;\n  }\n\n  private xForText() {\n    return this.nodeWidth() / 2;\n  }\n\n  private yForText() {\n    // svg ignores padding for some reason\n    return this.height / 2;\n  }\n\n  static idByName(name: string) {\n    if (Node.all[name] === undefined) throw `Unknown node \"${name}\"`;\n    return Node.all[name];\n  }\n\n  public nodeId() {\n    return classify(this.name);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static render(layer: d3.Selection<any>, nodes: Node[]) {\n    const node: d3.Selection<Node> = layer\n      .selectAll(\".node\")\n      .data(nodes)\n      .enter()\n      .append(\"g\")\n      .attr(\"id\", (d) => d.nodeId())\n      .attr(\"name\", (d) => d.name)\n      .attr(\"transform\", (d) => d.transform());\n\n    node.each(function (this: SVGGElement, d) {\n      if (d.icon) Node.appendImage(this);\n      else Node.appendRect(this);\n\n      Node.appendText(this);\n    });\n\n    return node;\n  }\n\n  private static appendText(container: SVGGElement) {\n    const text = (d3.select(container) as d3.Selection<Node>)\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", (d) => d.xForText())\n      .attr(\"y\", (d) => d.yForText());\n    text\n      .append(\"tspan\")\n      .text((d) => d.name)\n      .attr(\"x\", (d) => d.xForText());\n\n    text.each((d) => {\n      // Show meta only when \"tooltip\" option is not configured\n      if (!d.options.tooltip) {\n        Node.appendMetaText(text, d.metaList);\n      }\n    });\n  }\n\n  private static appendMetaText(container: d3.Selection<Node>, meta: MetaDataType[]) {\n    meta.forEach((m) => {\n      container\n        .append(\"tspan\")\n        .attr(\"x\", (d) => d.xForText())\n        .attr(\"dy\", (d) => d.tspanOffset)\n        .attr(\"class\", m.class)\n        .text(m.value);\n    });\n  }\n\n  private static appendImage(container: SVGGElement) {\n    (d3.select(container) as d3.Selection<Node>)\n      .attr(\"class\", (d) => `node image ${classify(d.name)} ${d.extraClass}`)\n      .append(\"image\")\n      .attr(\"xlink:href\", (d) => d.icon)\n      .attr(\"width\", (d) => d.nodeWidth())\n      .attr(\"height\", (d) => d.nodeHeight());\n  }\n\n  private static appendRect(container: SVGGElement) {\n    (d3.select(container) as d3.Selection<Node>)\n      .attr(\"class\", (d) => `node rect ${classify(d.name)} ${d.extraClass}`)\n      .append(\"rect\")\n      .attr(\"width\", (d) => d.nodeWidth())\n      .attr(\"height\", (d) => d.nodeHeight())\n      .attr(\"rx\", 5)\n      .attr(\"ry\", 5)\n      .style(\"fill\", (d) => d.options.color(undefined));\n  }\n\n  static tick(node: d3.Selection<Node>) {\n    node.attr(\"transform\", (d) => d.transform());\n  }\n\n  static setPosition(node: d3.Selection<Node>, position: NodePosition[]) {\n    node.attr(\"transform\", (d, i) => {\n      if (\n        position[i]?.x !== null &&\n        position[i]?.x !== undefined &&\n        position[i]?.y !== null &&\n        position[i]?.y !== undefined\n      ) {\n        d.x = position[i].x;\n        d.y = position[i].y;\n      }\n      return d.transform();\n    });\n  }\n\n  static reset() {\n    Node.all = null;\n  }\n}\n\nconst Eventable = (Base: typeof NodeBase) => {\n  class EventableNode extends Base {\n    private dispatch: d3.Dispatch;\n\n    constructor(data: NodeDataType, id: number, options: NodeOptions) {\n      super(data, id, options);\n\n      this.dispatch = d3.dispatch(\"rendered\");\n    }\n\n    static render(layer, nodes) {\n      const node = super.render(layer, nodes);\n\n      node.each(function (this: SVGGElement, d: Node & EventableNode) {\n        d.dispatch.rendered(this);\n      });\n\n      return node;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    on(name: string, callback: (element: SVGGElement) => any) {\n      this.dispatch.on(name, callback);\n    }\n  }\n\n  return EventableNode;\n};\n\nconst Pluggable = (Base: typeof NodeBase) => {\n  class Node extends Base {\n    private static pluginConstructors: Constructor[] = [];\n\n    constructor(data: NodeDataType, id: number, options: NodeOptions) {\n      super(data, id, options);\n\n      for (const constructor of Node.pluginConstructors) {\n        // Call Pluggable at last as constructor may call methods defined in other classes\n        constructor.bind(this)(data, id, options);\n      }\n    }\n\n    static registerConstructor(func: Constructor) {\n      Node.pluginConstructors.push(func);\n    }\n  }\n\n  return Node;\n};\n\nclass EventableNode extends Eventable(NodeBase) {}\n\n// Call Pluggable at last as constructor may call methods defined in other classes\nclass Node extends Pluggable(EventableNode) {}\n\nexport { Node };\n","import * as d3 from \"d3\";\n\nimport { Bundle } from \"./bundle\";\nimport { MetaData, MetaDataType } from \"./meta_data\";\nimport { Node } from \"./node\";\nimport { LinkPosition } from \"./position_cache\";\nimport { classify } from \"./util\";\n\nexport type Constructor = (data: LinkDataType, id: number, metaKeys: string[], linkWidth: (object) => number) => void;\n\nexport type LinkDataType = {\n  source: string;\n  target: string;\n  bundle?: number | string;\n  meta: Record<string, any>; // eslint-disable-line @typescript-eslint/no-explicit-any\n  class: string;\n};\n\nexport type LinkOptions = {\n  metaKeys: string[];\n  linkWidth: (object) => number;\n};\n\nexport class LinkBase {\n  private static groups: Record<string, number[]>;\n  private static scale?: number;\n\n  public readonly bundle?: number | string;\n  public readonly source: number | Node;\n  public readonly target: number | Node;\n  public readonly metaList: MetaDataType[];\n  public readonly sourceMeta: MetaDataType[];\n  public readonly targetMeta: MetaDataType[];\n\n  private readonly extraClass: string;\n  private width: number;\n  private readonly defaultMargin: number;\n  private readonly labelXOffset: number;\n  private readonly labelYOffset: number;\n  private color: string;\n  private _margin: number;\n  private _shiftMultiplier: number;\n\n  constructor(\n    data: LinkDataType,\n    public id: number,\n    private options: LinkOptions,\n  ) {\n    this.source = Node.idByName(data.source);\n    this.target = Node.idByName(data.target);\n    this.bundle = data.bundle;\n    this.metaList = new MetaData(data.meta).get(options.metaKeys);\n    this.sourceMeta = new MetaData(data.meta, \"source\").get(options.metaKeys);\n    this.targetMeta = new MetaData(data.meta, \"target\").get(options.metaKeys);\n    this.extraClass = data.class || \"\";\n\n    if (typeof options.linkWidth === \"function\") this.width = options.linkWidth(data.meta) || 3;\n    else this.width = options.linkWidth || 3;\n\n    this.defaultMargin = 15;\n    this.labelXOffset = 20;\n    this.labelYOffset = 1.5; // em\n    this.color = \"#7a4e4e\";\n\n    this.register(id);\n  }\n\n  private register(id: number) {\n    Link.groups = Link.groups || {};\n\n    // source and target\n    const key = [this.source, this.target].sort().toString();\n    (Link.groups[key] || (Link.groups[key] = [])).push(id);\n  }\n\n  private isLabelledPath() {\n    return this.metaList.length > 0;\n  }\n\n  private isReversePath() {\n    return this.targetMeta.length > 0;\n  }\n\n  d() {\n    return `M ${(this.source as Node).x} ${(this.source as Node).y} L ${(this.target as Node).x} ${\n      (this.target as Node).y\n    }`;\n  }\n\n  private pathId() {\n    return `path${this.id}`;\n  }\n\n  public linkId() {\n    return `link${this.id}`;\n  }\n\n  private margin() {\n    if (!this._margin) {\n      const margin = window.getComputedStyle(document.getElementById(this.linkId())).margin;\n\n      // NOTE: Assuming that window.getComputedStyle() returns some value link \"10px\"\n      // or \"0px\" even when not defined in .css\n      if (!margin || margin === \"0px\") {\n        this._margin = this.defaultMargin;\n      } else {\n        this._margin = parseInt(margin);\n      }\n    }\n\n    return this._margin;\n  }\n\n  private isLabelVisible() {\n    const pathLength = (document.getElementById(this.pathId()) as unknown as SVGPathElement).getTotalLength();\n\n    const isShort = Array.from(document.getElementsByClassName(this.pathId())).some((p) => {\n      // <text /> has only one <textPath />\n      const tp = p.firstChild as SVGTextPathElement;\n      // center label\n      if (tp.classList.contains(\"center\")) {\n        return tp.getComputedTextLength() > pathLength;\n      } else {\n        return tp.getComputedTextLength() + this.labelXOffset > pathLength;\n      }\n    });\n\n    d3.selectAll(`text.${this.pathId()}`).classed(\"short\", isShort);\n\n    // Link.scale is initially undefined\n    return Link.scale > 1.5 && !isShort;\n  }\n\n  group(): number[] {\n    return Link.groups[[(this.source as Node).id, (this.target as Node).id].sort().toString()];\n  }\n\n  // OPTIMIZE: Implement better right-alignment of the path, especially for multi tspans\n  private tspanXOffset() {\n    switch (true) {\n      case this.isLabelledPath():\n        return 0;\n      case this.isReversePath():\n        return -this.labelXOffset;\n      default:\n        return this.labelXOffset;\n    }\n  }\n\n  private tspanYOffset() {\n    if (this.isLabelledPath()) return `${-this.labelYOffset + 0.7}em`;\n    else return `${this.labelYOffset}em`;\n  }\n\n  private rotate(bbox: SVGRect) {\n    if ((this.source as Node).x > (this.target as Node).x)\n      return `rotate(180 ${bbox.x + bbox.width / 2} ${bbox.y + bbox.height / 2})`;\n    else return \"rotate(0)\";\n  }\n\n  private split() {\n    if (!this.metaList && !this.sourceMeta && !this.targetMeta) return [this];\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const meta: Record<string, any>[] = [];\n    [\"metaList\", \"sourceMeta\", \"targetMeta\"].forEach((key, i, keys) => {\n      if (this[key]) {\n        const duped = Object.assign(Object.create(this), this);\n\n        keys.filter((k) => k !== key).forEach((k) => (duped[k] = []));\n        meta.push(duped);\n      }\n    });\n\n    return meta;\n  }\n\n  private hasMeta() {\n    return this.metaList.length > 0 || this.sourceMeta.length > 0 || this.targetMeta.length > 0;\n  }\n\n  class() {\n    return `link ${classify((this.source as Node).name)} ${classify((this.target as Node).name)} ${classify(\n      (this.source as Node).name,\n    )}-${classify((this.target as Node).name)} ${this.extraClass}`;\n  }\n\n  // after transform is applied\n  centerCoordinates() {\n    const link = d3.select(`.link #${this.linkId()}`).node() as SVGLineElement;\n    const bbox = link.getBBox();\n    const transform = link.transform.baseVal.consolidate();\n\n    return [\n      bbox.x + bbox.width / 2 + (transform?.matrix.e || 0),\n      bbox.y + bbox.height / 2 + (transform?.matrix.f || 0),\n    ];\n  }\n\n  angle() {\n    const link = d3.select(`.link #${this.linkId()}`).node() as SVGLineElement;\n    return (\n      (Math.atan2(link.y2.baseVal.value - link.y1.baseVal.value, link.x2.baseVal.value - link.x1.baseVal.value) * 180) /\n      Math.PI\n    );\n  }\n\n  static render(\n    linkLayer: d3.Selection<any>, // eslint-disable-line @typescript-eslint/no-explicit-any\n    labelLayer: d3.Selection<any>, // eslint-disable-line @typescript-eslint/no-explicit-any\n    links: Link[],\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ): [d3.Selection<Link>, d3.Selection<Link>, d3.Selection<any>] {\n    // Render lines\n    const pathGroup = linkLayer\n      .selectAll(\".link\")\n      .data(links)\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", (d) => d.class());\n\n    const link = pathGroup\n      .append(\"line\")\n      .attr(\"x1\", (d) => (d.source as Node).x)\n      .attr(\"y1\", (d) => (d.source as Node).y)\n      .attr(\"x2\", (d) => (d.target as Node).x)\n      .attr(\"y2\", (d) => (d.target as Node).y)\n      .attr(\"stroke\", (d) => d.color)\n      .attr(\"stroke-width\", (d) => d.width)\n      .attr(\"id\", (d) => d.linkId())\n      .on(\"mouseover.line\", (d) => textGroup.selectAll(`text.${d.pathId()}`).classed(\"hover\", true))\n      .on(\"mouseout.line\", (d) => textGroup.selectAll(`text.${d.pathId()}`).classed(\"hover\", false));\n\n    const path = pathGroup\n      .append(\"path\")\n      .attr(\"d\", (d) => d.d())\n      .attr(\"id\", (d) => d.pathId());\n\n    // Render texts\n    const textGroup = labelLayer\n      .selectAll(\".link\")\n      .data(links)\n      .enter()\n      .append(\"g\")\n      .attr(\"class\", (d) => d.class());\n\n    const text = textGroup\n      .selectAll(\"text\")\n      .data((d: Link) => d.split().filter((l: Link) => l.hasMeta()))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", (d: Link) => d.pathId()); // Bind text with pathId as class\n\n    const textPath = text.append(\"textPath\").attr(\"xlink:href\", (d: Link) => `#${d.pathId()}`);\n\n    textPath.each(function (d: Link) {\n      Link.appendMetaText(this, d.metaList);\n      Link.appendMetaText(this, d.sourceMeta);\n      Link.appendMetaText(this, d.targetMeta);\n\n      if (d.isLabelledPath()) Link.center(this);\n\n      if (d.isReversePath()) Link.theOtherEnd(this);\n    });\n\n    Link.zoom(); // Initialize\n    return [link, path, text];\n  }\n\n  private static theOtherEnd(container: SVGGElement) {\n    d3.select(container).attr(\"class\", \"reverse\").attr(\"text-anchor\", \"end\").attr(\"startOffset\", \"100%\");\n  }\n\n  private static center(container: SVGGElement) {\n    d3.select(container).attr(\"class\", \"center\").attr(\"text-anchor\", \"middle\").attr(\"startOffset\", \"50%\");\n  }\n\n  private static appendMetaText(container: SVGGElement, meta: MetaDataType[]) {\n    meta.forEach((m) => {\n      d3.select(container)\n        .append(\"tspan\")\n        .attr(\"x\", (d: Link) => d.tspanXOffset())\n        .attr(\"dy\", (d: Link) => d.tspanYOffset())\n        .attr(\"class\", m.class)\n        .text(m.value);\n    });\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static tick(link: d3.Selection<Link>, path?: d3.Selection<Link>, label?: d3.Selection<any>) {\n    link\n      .attr(\"x1\", (d) => (d.source as Node).x)\n      .attr(\"y1\", (d) => (d.source as Node).y)\n      .attr(\"x2\", (d) => (d.target as Node).x)\n      .attr(\"y2\", (d) => (d.target as Node).y);\n\n    if(path) {\n      path.attr(\"d\", (d) => d.d());\n    }\n\n    if(label) {\n      label.attr(\"transform\", function(d: Link) {\n        return d.rotate(this.getBBox());\n      });\n    }\n\n    // hide labels when the path is too short\n    d3.selectAll(\".link text\").style(\"visibility\", (d: Link) => (d.isLabelVisible() ? \"visible\" : \"hidden\"));\n  }\n\n  static zoom(scale?: number) {\n    Link.scale = scale;\n\n    d3.selectAll(\".link text\").style(\"visibility\", (d: Link) => (d.isLabelVisible() ? \"visible\" : \"hidden\"));\n  }\n\n  static setPosition(link: d3.Selection<Link>, position: LinkPosition[]) {\n    link\n      .attr(\"x1\", (d, i) => position[i].x1)\n      .attr(\"y1\", (d, i) => position[i].y1)\n      .attr(\"x2\", (d, i) => position[i].x2)\n      .attr(\"y2\", (d, i) => position[i].y2);\n  }\n\n  private shiftMultiplier() {\n    if (!this._shiftMultiplier) {\n      const members = this.group() || [];\n      this._shiftMultiplier = members.indexOf(this.id) - (members.length - 1) / 2;\n    }\n\n    return this._shiftMultiplier;\n  }\n\n  static shiftBundle(\n    link: d3.Selection<Link>,\n    path: d3.Selection<Link>,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    label: d3.Selection<any>,\n    bundle: d3.Selection<Bundle>,\n  ) {\n    const transform = (d: Link) => d.shiftBundle(d.shiftMultiplier());\n\n    link.attr(\"transform\", transform);\n    path.attr(\"transform\", transform);\n    label.attr(\"transform\", transform);\n    Bundle.shiftBundle(bundle);\n  }\n\n  shiftBundle(multiplier: number) {\n    const gap = this.margin() * multiplier;\n\n    const x = (this.target as Node).x - (this.source as Node).x;\n    const y = (this.target as Node).y - (this.source as Node).y;\n    const length = Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\n\n    return `translate(${(-gap * y) / length}, ${(gap * x) / length})`;\n  }\n\n  static reset() {\n    Link.groups = null;\n  }\n}\n\nconst Eventable = (Base: typeof LinkBase) => {\n  class EventableLink extends Base {\n    private dispatch: d3.Dispatch;\n\n    constructor(data: LinkDataType, id: number, options: LinkOptions) {\n      super(data, id, options);\n\n      this.dispatch = d3.dispatch(\"rendered\");\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    static render(linkLayer, labelLayer, links): [d3.Selection<Link>, d3.Selection<Link>, d3.Selection<any>] {\n      const [link, path, text] = super.render(linkLayer, labelLayer, links);\n\n      link.each(function (this: SVGLineElement, d: Link & EventableLink) {\n        d.dispatch.rendered(this);\n      });\n\n      return [link, path, text];\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    on(name: string, callback: (element: SVGGElement) => any) {\n      this.dispatch.on(name, callback);\n    }\n  }\n\n  return EventableLink;\n};\n\nconst Pluggable = (Base: typeof LinkBase) => {\n  class Link extends Base {\n    private static pluginConstructors: Constructor[] = [];\n\n    constructor(data: LinkDataType, id: number, options: LinkOptions) {\n      super(data, id, options);\n\n      for (const constructor of Link.pluginConstructors) {\n        // Call Pluggable at last as constructor may call methods defined in other classes\n        constructor.bind(this)(data, id, options);\n      }\n    }\n\n    static registerConstructor(func: Constructor) {\n      Link.pluginConstructors.push(func);\n    }\n  }\n\n  return Link;\n};\n\nclass EventableLink extends Eventable(LinkBase) {}\n\n// Call Pluggable at last as constructor may call methods defined in other classes\nclass Link extends Pluggable(EventableLink) {}\n\nexport { Link };\n","import * as d3 from \"d3\";\n\nimport { Constructor as LinkConstructor, Link, LinkDataType } from \"../../../src/link\";\nimport { Node } from \"../../../src/node\";\nimport { PluginClass } from \"../../../src/plugin\";\n\nclass ArrowsLink extends Link {\n  public readonly source: number | Node;\n  public readonly target: number | Node;\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static tick(link: d3.Selection<ArrowsLink>, path: d3.Selection<ArrowsLink>, label: d3.Selection<any>) {\n    super.tick(link, path, label);\n\n    link.attr(\"x2\", (d) => d.x2());\n    link.attr(\"y2\", (d) => d.y2());\n  }\n\n  length() {\n    return Math.sqrt(\n      ((this.source as Node).x - (this.target as Node).x) ** 2 +\n        ((this.source as Node).y - (this.target as Node).y) ** 2,\n    );\n  }\n\n  x2() {\n    return (this.source as Node).x + (0.5 - 5 / this.length()) * ((this.target as Node).x - (this.source as Node).x);\n  }\n\n  y2() {\n    return (this.source as Node).y + (0.5 - 5 / this.length()) * ((this.target as Node).y - (this.source as Node).y);\n  }\n}\n\nexport const ArrowsLinkPlugin: PluginClass = class ArrowsLinkPlugin {\n  private static isMarkerDefined = false;\n\n  static load(Group, Node, Link) {\n    Link.registerConstructor(function (\n      /* eslint-disable @typescript-eslint/no-unused-vars */\n      data: LinkDataType,\n      id: number,\n      metaKeys: string[],\n      linkWidth: (object) => number,\n      /* eslint-enable @typescript-eslint/no-unused-vars */\n    ) {\n      this.selected = false;\n\n      this.on(\"rendered\", (element: SVGLineElement) => {\n        ArrowsLinkPlugin.appendMarker(element);\n        if (!ArrowsLinkPlugin.isMarkerDefined) {\n          ArrowsLinkPlugin.defineMarkers();\n        }\n      });\n    } as LinkConstructor);\n\n    // Copy methods\n    Link.tick = ArrowsLink.tick;\n    Link.prototype.length = ArrowsLink.prototype.length;\n    Link.prototype.x2 = ArrowsLink.prototype.x2;\n    Link.prototype.y2 = ArrowsLink.prototype.y2;\n  }\n\n  private static defineMarkers() {\n    const defs = d3.select(\"svg\").append(\"defs\");\n    const define = (id: string) => {\n      defs\n        .append(\"marker\")\n        .attr(\"id\", id)\n        .attr(\"markerWidth\", 10)\n        .attr(\"markerHeight\", 7)\n        .attr(\"refX\", 7.5)\n        .attr(\"orient\", \"auto\")\n        .attr(\"viewBox\", \"0 -5 10 10\")\n        .append(\"path\")\n        .attr(\"d\", \"M0,-5 L10,0 L0,5\");\n    };\n\n    define(\"marker-odd\");\n    define(\"marker-even\");\n    ArrowsLinkPlugin.isMarkerDefined = true;\n  }\n\n  private static appendMarker(element: SVGLineElement) {\n    d3.select(element).attr(\n      \"marker-end\",\n      // For consistency with #links :nth-child(odd), it's one-based\n      (d: ArrowsLink) => (d.id % 2 === 0 ? \"url(#marker-odd)\" : \"url(#marker-even)\"),\n    );\n  }\n};\n\nexport default ArrowsLinkPlugin;\n"],"names":["root","factory","exports","module","require","define","amd","a","i","self","__WEBPACK_EXTERNAL_MODULE__893__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","Bundle","constructor","links","id","this","color","width","space","divide","groups","l","bundle","groupKey","push","values","map","ids","link","JSON","stringify","source","target","render","linkLayer","bundles","selectAll","data","enter","append","attr","class","bundleId","reset","sortByBundle","sort","b","toString","first","centerCoordinates","last","length","gap","Math","sqrt","pow","angle","start","end","shiftMultiplier","_shiftMultiplier","members","group","reduce","sum","shiftBundle","replace","MetaData","extraKey","keys","slice","filter","k","sliceWithExtraKey","sliceWithoutExtraKey","forEach","classify","string","toLowerCase","NodeBase","options","name","icon","metaList","meta","metaKeys","extraClass","height","padding","tspanOffset","register","Node","all","transform","x","y","nodeWidth","nodeHeight","xForText","yForText","idByName","nodeId","layer","nodes","node","each","appendImage","appendRect","appendText","container","text","tooltip","appendMetaText","m","style","tick","setPosition","position","Eventable","Base","super","dispatch","rendered","on","callback","Pluggable","pluginConstructors","bind","registerConstructor","func","EventableNode","LinkBase","sourceMeta","targetMeta","linkWidth","defaultMargin","labelXOffset","labelYOffset","Link","isLabelledPath","isReversePath","pathId","linkId","margin","_margin","window","getComputedStyle","document","getElementById","parseInt","isLabelVisible","pathLength","getTotalLength","isShort","Array","from","getElementsByClassName","some","p","tp","firstChild","classList","contains","getComputedTextLength","classed","scale","tspanXOffset","tspanYOffset","rotate","bbox","split","duped","assign","create","hasMeta","getBBox","baseVal","consolidate","matrix","e","f","atan2","y2","y1","x2","x1","PI","labelLayer","pathGroup","textGroup","path","center","theOtherEnd","zoom","label","indexOf","multiplier","EventableLink","ArrowsLink","ArrowsLinkPlugin","load","Group","selected","element","appendMarker","isMarkerDefined","defineMarkers","defs"],"sourceRoot":""}