!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("d3"));else if("function"==typeof define&&define.amd)define(["d3"],e);else{var s="object"==typeof exports?e(require("d3")):e(t.d3);for(var r in s)("object"==typeof exports?exports:t)[r]=s[r]}}(window,(function(t){return function(t){var e={};function s(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=t,s.c=e,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(r,i,function(e){return t[e]}.bind(null,i));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=1)}([function(e,s){e.exports=t},function(t,e,s){"use strict";s.r(e),s.d(e,"RemovableNodePlugin",(function(){return u}));var r=s(0);class i{constructor(t,e){this.data=t,this.extraKey=e}get(t){return this.slice(t).filter(t=>"string"==typeof t.value)}slice(t){return this.data?this.extraKey?this.sliceWithExtraKey(t):this.sliceWithoutExtraKey(t):[]}sliceWithExtraKey(t){const e=[];return t.forEach(t=>{this.data[t]&&this.data[t][this.extraKey]&&e.push({class:t,value:this.data[t][this.extraKey]})}),e}sliceWithoutExtraKey(t){const e=[];return t.forEach(t=>{this.data[t]&&e.push({class:t,value:this.data[t]})}),e}}function n(t){return t.replace(" ","-").toLowerCase()}class o{constructor(t,e,s,r,n){this.id=e,this.color=r,this.tooltip=n,this.name=t.name,this.group="string"==typeof t.group?[t.group]:t.group||[],this.icon=t.icon,this.meta=new i(t.meta).get(s),this.extraClass=t.class||"",this.width=60,this.height=40,this.padding=3,this.tspanOffset="1.1em",this.register(e,t.name)}register(t,e){d.all=d.all||{},d.all[e]=t}transform(){return`translate(${this.x-this.width/2+this.padding}, ${this.y-this.height/2+this.padding})`}nodeWidth(){return this.width-2*this.padding}nodeHeight(){return this.height-2*this.padding}xForText(){return this.width/2}yForText(){return this.height/2}static idByName(t){if(void 0===d.all[t])throw`Unknown node "${t}"`;return d.all[t]}static render(t,e){const s=t.selectAll(".node").data(e).enter().append("g").attr("id",t=>n(t.name)).attr("name",t=>t.name).attr("transform",t=>t.transform());return s.each((function(t){t.icon?d.appendImage(this):d.appendRect(this),d.appendText(this)})),s}static appendText(t){const e=r.select(t).append("text").attr("text-anchor","middle").attr("x",t=>t.xForText()).attr("y",t=>t.yForText());e.append("tspan").text(t=>t.name).attr("x",t=>t.xForText()),e.each(t=>{t.tooltip||d.appendTspans(e,t.meta)})}static appendTspans(t,e){e.forEach(e=>{t.append("tspan").attr("x",t=>t.xForText()).attr("dy",t=>t.tspanOffset).attr("class",e.class).text(e.value)})}static appendImage(t){r.select(t).attr("class",t=>`node image ${n(t.name)} ${t.extraClass}`).append("image").attr("xlink:href",t=>t.icon).attr("width",t=>t.nodeWidth()).attr("height",t=>t.nodeHeight())}static appendRect(t){r.select(t).attr("class",t=>`node rect ${n(t.name)} ${t.extraClass}`).append("rect").attr("width",t=>t.nodeWidth()).attr("height",t=>t.nodeHeight()).attr("rx",5).attr("ry",5).style("fill",t=>t.color())}static tick(t){t.attr("transform",t=>t.transform())}static setPosition(t,e){t.attr("transform",(t,s)=>(t.x=e[s].x,t.y=e[s].y,t.transform()))}static reset(){d.all=null}}const a=t=>class extends t{constructor(t,e,s,i,n){super(t,e,s,i,n),this.dispatch=r.dispatch("rendered")}static render(t,e){const s=super.render(t,e);return s.each((function(t){t.dispatch.rendered(this)})),s}on(t,e){this.dispatch.on(t,e)}},l=t=>{class e extends t{constructor(t,s,r,i,n){super(t,s,r,i,n);for(const o of e.pluginConstructors)o.bind(this)(t,s,r,i,n)}static registerConstructor(t){e.pluginConstructors.push(t)}}return e.pluginConstructors=[],e};class c extends(a(o)){}class d extends(l(c)){}var h;class p extends d{toggleSelected(){this.selected=!this.selected}reset(){this.selected=!1}textColor(){return this.selected?"red":"black"}}const u=((h=class t{static load(e,s,r,i={}){i.showKey&&(t.showKey=i.showKey),i.hideKey&&(t.hideKey=i.hideKey),s.registerConstructor((function(e,s,r,i,n){this.selected=!1,this.on("rendered",e=>{t.configureRemovableNode(e)})})),t.configureRemovableNodes(),s.prototype.toggleSelected=p.prototype.toggleSelected,s.prototype.reset=p.prototype.reset,s.prototype.textColor=p.prototype.textColor}static configureRemovableNodes(){r.select("body").on("keydown",()=>{switch(r.event.key){case t.showKey:t.show();break;case t.hideKey:t.hide()}})}static configureRemovableNode(e){r.select(e).on("click.removableNode",(function(e){r.event.defaultPrevented||(e.toggleSelected(),t.applyColor(this))}))}static applyColor(t){r.select(t).select("text tspan").style("fill",t=>t.textColor())}static show(){r.selectAll(".node").style("display","inline").each((function(e){e.reset(),t.applyColor(this)})),t.showLinks()}static hide(){r.selectAll(".node").style("display",e=>e.selected?(t.hideLinks(e.name),t.hideToolTips(e.name),"none"):"inline")}static showLinks(){r.selectAll(".link").style("display","inline")}static hideLinks(t){r.selectAll(".link."+n(t)).style("display","none")}static hideToolTips(t){r.selectAll(".tooltip."+n(t)).attr("visibility","hidden")}}).showKey="Escape",h.hideKey="d",h);e.default=u}])}));
//# sourceMappingURL=plugin.min.js.map